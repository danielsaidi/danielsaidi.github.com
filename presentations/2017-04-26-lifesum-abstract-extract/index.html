<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>Abstract, Extract</title>

		<meta name="description" content="New Audio Player Demo">
		<meta name="author" content="Daniel Saidi, daniel.saidi@gmail.com">

		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

		<link rel="stylesheet" href="../css/reveal.css">
		<link rel="stylesheet" href="../css/theme/bookbeat.css" id="theme">

		<!-- Code syntax highlighting -->
		<link rel="stylesheet" href="../lib/css/zenburn.css">

		<link href='https://fonts.googleapis.com/css?family=Playfair+Display:400,400italic,700,700italic,900,900italic' rel='stylesheet' type='text/css'>

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? '../css/print/pdf.css' : '../css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>

		<style>
			.title-page h1 { font-size: 4em !important; }
			.title-page p { font-weight: bold; }
			h2 { font-size: 2em !important; }
			pre { background-color: white; }
		</style>

		<!--[if lt IE 9]>
		<script src="../lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">
				<section data-markdown class="title-page">
					# Abstract, Extract
					## How to untie that libifying your source code ....TBD

					@danielsaidi
				</section>


				<section>
					<section data-markdown>
						# Daniel
						### iOS Lead @ BookBeat
					</section>

					<section data-markdown>
						## Previously
						* .NET
						* Web
						* Android
						* Java, C / C++
						* Windows Mobile...
					</section>

					<section data-markdown class="image-section" data-background="http://thesuburbansoapbox.com/wp-content/uploads/2013/04/image39.jpg">
						# Mmmm...a full stack!
					</section>

					<section data-markdown>
						## Previous roles
						* .NET Developer
						* System Architect
						* Lead Developer
						* Dev Team Coach
					</section>

					<section data-markdown>
						## Love
						* Web
						* Mobile
						* Code
						* Methodology
					</section>
				</section>


				<section>
					<section data-markdown>
						# BookBeat
					</section>

					<section data-markdown>
						## Audio Books
						* Stream & Download
						* Monthly fee, unlimited use
						* Soft launch late 2015
						* Real launch spring 2016
					</section>

					<section data-markdown>
						## Competitors
						* Audible
						* Storytel
						* Nextory
						* ...and many many more
					</section>

					<section data-markdown>
						## Challenge
						* Proven business model
						* But new to Bonnier
						* Not only a technical challenge
						* Starting a whole new company
					</section>

					<section data-markdown>
						## Questions
						* What should we do?
						* How should we do it?
						* How much do we charge?
						* Partnerships, publishers, reporting?
					</section>

					<section data-markdown>
						## Marketing
						* What should we call it?
						* Graphics, fonts, colors
						* Tonality
						* Marketing channels
					</section>

					<section data-markdown>
						## Tech
						* Client platforms 
						* Backend
						* Api(s)
						* Integrations
					</section>

					<section data-markdown>
						## Team
						* Started small
						* Consultants only
						* Recruited gradually
						* Today, few consultants
					</section>

					<section data-markdown>
						## Process
						* Pivot, pivot, pivot
						* Constant discovery
						* Constant change
						* Tech must be adaptable
					</section>

					<section data-markdown class="image-section" data-background="https://img.devrant.io/devrant/rant/r_97625_fwDNP.gif">
					</section>

					<section data-markdown>
						## Code Approach 
						* Adaptability over architecture
						* Build it right once we know
						* Avoid premature optimization
						* Cover the most important parts in tests
					</section>

					<section data-markdown>
						## Result 
						* Constant, quick changes
						* Affected code base, but...
						* Many great things in place
						* They got an app out (business value)!
					</section>
				</section>


				<section>
					<section data-markdown>
						# Keeping it together
					</section>

					<section data-markdown>
						## Quick changes
						* How do you handle quick changes?
						* How do you keep your code base sane?
						* SHOULD you focus on architecture, when everything constantly changes?
					</section>

					<section data-markdown>
						## Spike & Stabilize
						* Dan North, 2011
						* Optimize for throwawayability
						* An active decision
						* Start as spike, stabilize if proven valuable
					</section>

					<section data-markdown>
						## Spike & Stabilize (cont.)
						* Good for changing scope, pivot etc.
						* Does NOT mean write "ad hoc code"
						* Optimize for THROWAWAYABILITY
						* Means it should be easy to throw away
					</section>

					<section data-markdown>
						# However...
					</section>

					<section data-markdown>
						## Signs of rushed coding
						* Copy/pasted code
						* Spaghetti code
						* Inconsistent system design
						* No "red thread"
					</section>

					<section data-markdown>
						## Signs of rushed coding
						* No abstractions (how, not what)
						* Hard coupling
						* Existing tests are disabled
						* No new tests can be added
					</section>

					<section data-markdown>
						## Signs of rushed coding
						* Shout out time!
					</section>
				</section>


				<section>
					<section data-markdown>
						# So, BookBeat?
					</section>

					<section data-markdown>
						## Remember...
						* They got an app out
						* However...
					</section>

					<section data-markdown>
						## Problems (challenges :)
						* CoreData everywhere
						* RestKit everywhere
						* Premature framework design
						* Rigid code
					</section>

					<section data-markdown>
						## Problems (cont.)
						* Slow build times
						* Existing unit tests disabled
						* Can't add tests (segmentation fault 11)
						* All logic in the app
					</section>

					<section data-markdown class="image-section" data-background="https://s-media-cache-ak0.pinimg.com/originals/03/ad/71/03ad71abf3741f3188428ff0d95d1616.gif">
					</section>

					<section data-markdown class="image-section" data-background="https://s-media-cache-ak0.pinimg.com/originals/db/91/c1/db91c177933567e8e1a10ba9da96cd02.jpg">
					</section>

					<section data-markdown>
						## (Our) Solution
						* Baby steps
						* Extract code into logical libraries
						* Hard for e.g. Book, begin with simpler
						* CocoaPods
					</section>

					<section data-markdown>
						## CocoaPods
						* Package Manager for iOS
						* Alternatives: Carthage, Swift PM
						* ✖ CocoaPod repo
						* ✔ Private git repo + Development pods
					</section>

					<section data-markdown>
						## Pros
						* Pods can be used in multiple apps
						* Minimize app's responsibility
						* Faster build → easier unit testing
						* Reduces coupling, forces abstraction
					</section>

					<section data-markdown>
						## Cons
						* Slower build times (not always)
						* Number of pods can add up
						* Sometimes too much complexity
						* Library versioning hell
					</section>

					<section data-markdown>
						## Our libraries
						* BBCore
						* BBAudioPlayer
						* BBDomain (wip)
						* App gets thinner and thinner
					</section>
				</section>

				<section>

					<section data-markdown>
						# Demo
					</section>

					<section data-markdown>
						## Initial setup
						* One app with all logic
						* API: RestaurantLite + ApiRestaurant
						* Realm - Restaurant
						* API-specific service
					</section>

					<section data-markdown>
						## Initial setup (cont.)
						* Realm-wrapper around API-service
						* API-entity used in lists
						* Realm entity used in detail page
						* Hard coupling to Alamofire and Realm
					</section>

					<section data-markdown>
						## Pod
						* RestaurantOverview
						* Restaurant: RestaurantOverview
						* Abstract service
						* Do not move API in here yet
					</section>

					<section data-markdown>
						## App
						* Rename API entities
						* Rename Realm entity
						* Add development pod
						* Make classes implement abstract
					</section>

					<section data-markdown>
						## App (cont.)
						* Make UI use abstract entities
						* Make services implement abstract
						* Inject abstract service into Realm
						* API can now be moved anywhere!
					</section>

					<section data-markdown>
						## App (cont.)
						* Discuss IoC
						* Add Dip
						* Bootstrap application
						* Run
					</section>
				</section>

				<section data-markdown>
					## Wrapping up
					* No silver bullet
					* What to keep in app depends on the app
					* This is just a way to solve possible problems in your code base
				</section>

				<section data-markdown>
					# Thank you!
					* @danielsaidi
				</section>
			</div>
		</div>

		<script src="../lib/js/head.min.js"></script>
		<script src="../js/reveal.js"></script>

		<script>

			// Full list of configuration options available at:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,

				transition: 'slide', // none/fade/slide/convex/concave/zoom

				// Optional reveal.js plugins
				dependencies: [
					{ src: '../lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: '../plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: '../plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: '../plugin/highlight/highlight.js', async: true, condition: function() { return !!document.querySelector( 'pre code' ); }, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: '../plugin/zoom-js/zoom.js', async: true },
					{ src: '../plugin/notes/notes.js', async: true }
				]
			});

		</script>

	</body>
</html>

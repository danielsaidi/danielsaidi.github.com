<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>Abstract, Extract</title>

		<meta name="description" content="New Audio Player Demo">
		<meta name="author" content="Daniel Saidi, daniel.saidi@gmail.com">

		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

		<link rel="stylesheet" href="../css/reveal.css">
		<link rel="stylesheet" href="../css/theme/bookbeat.css" id="theme">

		<!-- Code syntax highlighting -->
		<link rel="stylesheet" href="../lib/css/zenburn.css">

		<link href='https://fonts.googleapis.com/css?family=Playfair+Display:400,400italic,700,700italic,900,900italic' rel='stylesheet' type='text/css'>

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? '../css/print/pdf.css' : '../css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>

		<style>
			.title-page h1 { font-size: 3em !important; }
			.title-page p { font-weight: bold; }
			.title-page h3 + ul li { font-size: 0.4em !important; }
			h2 { font-size: 2em !important; }
			pre { background-color: white; }
			.image-section.light h1, .image-section.light h3 { color: black !important; text-shadow: 2px 2px white !important; }
		</style>

		<!--[if lt IE 9]>
		<script src="../lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">
				<section data-markdown class="title-page">
					# Abstract, Extract
					### How abstractions and libraries can help you untie that big ball of twine that is your sorry excuse of a source code *

					* \* Come up with a better title before Wednesday
				</section>


				<section>
					<section data-markdown>
						# @danielsaidi
						### iOS Lead @ BookBeat
					</section>

					<section data-markdown>
						<script type="text/template">
						## Before that
						* .NET <!-- .element: class="fragment" -->
						* Web <!-- .element: class="fragment" -->
						* Android <!-- .element: class="fragment" -->
						* Java, Python, C / C++ <!-- .element: class="fragment" -->
						</script>
					</section>

					<section data-markdown class="image-section" data-background="cool.gif">
						# Windows Mobile 2005
						### Before it was cool
					</section>

					<section data-markdown>
						<script type="text/template">
						## Previous roles
						* .NET Developer <!-- .element: class="fragment" -->
						* System Architect <!-- .element: class="fragment" -->
						* Lead Developer <!-- .element: class="fragment" -->
						* Head of Mobile <!-- .element: class="fragment" -->
						</script>
					</section>

					<section data-markdown class="image-section" data-background="team-yellow.jpg">
						# Team Yellow
					</section>
				</section>

				<section>

					<section data-markdown>
						# So why am I here?
					</section>

					<section data-markdown>
						<script type="text/template">
						## Code quality
						* Very important to me (too important) <!-- .element: class="fragment" -->
						* Constant work in progress <!-- .element: class="fragment" -->
						* ...and yet, I often suck at it <!-- .element: class="fragment" -->
						* Strange how hard the easy is <!-- .element: class="fragment" -->
						</script>
					</section>

					<section data-markdown class="image-section" data-background="rube.png">
					</section>

					<section data-markdown>
						<script type="text/template">
						## Today's talk
						* BookBeat case study <!-- .element: class="fragment" -->
						* How did they get to where they are <!-- .element: class="fragment" -->
						* iOS-specific challenges <!-- .element: class="fragment" -->
						* My approach to solve them <!-- .element: class="fragment" -->
						</script>
					</section>
				</section>


				<section>
					<section data-markdown>
						# BookBeat
						### A startup story
					</section>

					<section data-markdown>
						<script type="text/template">
						## Audio Books & e-books
						* Stream & Download <!-- .element: class="fragment" -->
						* Monthly fee, unlimited use <!-- .element: class="fragment" -->
						* Soft launched late 2015 <!-- .element: class="fragment" -->
						* Real launch spring 2016 <!-- .element: class="fragment" -->
						</script>
					</section>

					<section data-markdown>
						## Competitors
						* Audible
						* Storytel
						* Nextory
						* ...and many others
					</section>

					<section data-markdown>
						<script type="text/template">
						## The Big Picture 
						* What should we do? <!-- .element: class="fragment" -->
						* How should we do it? <!-- .element: class="fragment" -->
						* Name, price, design, tonality <!-- .element: class="fragment" -->
						* Partnerships, publishers, reporting? <!-- .element: class="fragment" -->
						</script>
					</section>

					<section data-markdown>
						<script type="text/template">
						## Tech
						* Backend <!-- .element: class="fragment" -->
						* Integrations <!-- .element: class="fragment" -->
						* Api(s) <!-- .element: class="fragment" -->
						* Applications <!-- .element: class="fragment" -->
						</script>
					</section>

					<section data-markdown>
						<script type="text/template">
						## Process
						* Discovery & learning driven <!-- .element: class="fragment" -->
						* Constant changes <!-- .element: class="fragment" -->
						* Fine-tune, change, pivot <!-- .element: class="fragment" -->
						* Adaptability is key <!-- .element: class="fragment" -->
						</script>
					</section>

					<section data-markdown>
						<script type="text/template">
						## Code
						* Adaptability over architecture <!-- .element: class="fragment" -->
						* Build it right once we know <!-- .element: class="fragment" -->
						* Avoid premature optimization <!-- .element: class="fragment" -->
						* (Apps) Test most important parts only <!-- .element: class="fragment" -->
						</script>
					</section>
				</section>


				<section>
					<section data-markdown>
						# Keeping it together
						### How do you keep your code base sane?
					</section>

					<section data-markdown>
						<script type="text/template">
						## Good practices
						* Minimize coupling <!-- .element: class="fragment" -->
						* Minimize inheritance <!-- .element: class="fragment" -->
						* Don't let external dependencies leak <!-- .element: class="fragment" -->
						* Keep it simple! <!-- .element: class="fragment" -->
						</script>
					</section>

					<section data-markdown>
						<script type="text/template">
						## Spike & Stabilize
						* Dan North, 2011 <!-- .element: class="fragment" -->
						* Good for changing scope, pivots etc. <!-- .element: class="fragment" -->
						* Optimize for throwawayability <!-- .element: class="fragment" -->
						* Code should be easy to throw away <!-- .element: class="fragment" -->
						</script>
					</section>

					<section data-markdown>
						<script type="text/template">
						## Prototype-driven
						* Start with a prototype <!-- .element: class="fragment" -->
						* Stabilize if proven valuable <!-- .element: class="fragment" -->
						* Throw away if proven worthless  <!-- .element: class="fragment" -->
						* Code MUST be easy to throw away <!-- .element: class="fragment" -->
						</script>
					</section>
				</section>

				<section>
					<section data-markdown>
						# But what if you fail?
						### How do you know if your code went bad?
					</section>

					<section data-markdown class="image-section" data-background="code-smell.gif">
						# Code-smell!
						### (it actually does smell)
					</section>

					<section data-markdown>
						<script type="text/template">
						## What is code smell?
						* Surface indication of deeper problems <!-- .element: class="fragment" -->
						* Violate fundamental design principles <!-- .element: class="fragment" -->
						* Usually not bugs, but can hide nasty ones <!-- .element: class="fragment" -->
						* Bad habits, inexperience, stress <!-- .element: class="fragment" -->
						</script>
					</section>

					<section data-markdown class="image-section" data-background="code-smell-hands.gif">
						# Raise of hands
						### Favorite code-smells?
					</section>

					<section data-markdown class="image-section light" data-background="copypaste.jpg">
						# Duplicated code
						### e.g. validation, formatting, business logic
					</section>

					<section data-markdown class="image-section light" data-background="complex-code.jpg">
						# Long functions
						### Hard to test, cyclomatic complexity
					</section>

					<section data-markdown class="image-section light" data-background="complex-code.jpg">
						# Complicated code
						### If your code needs comments, you know
					</section>

					<section data-markdown class="image-section light" data-background="large-class.jpg">
						# Large classes
						### Does a lot of stuff...that it shouldn't
					</section>

					<section data-markdown class="image-section" data-background="spaghetti.jpg">
						# Spaghetti code
						### No red thread, no obvious design
					</section>

					<section data-markdown class="image-section" data-background="coupling.jpg">
						# Hard coupling
						### A depends on B which depends on...
					</section>

					<section data-markdown class="image-section" data-background="bad-habits.jpg">
						# Bad habits
						### Unit tests disabled, no version control etc.
					</section>

					<section data-markdown>
						<script type="text/template">
						## Dangers
						* Hacking is quick at first <!-- .element: class="fragment" -->
						* Often appreciated by management <!-- .element: class="fragment" -->
						* New features constantly delivered  <!-- .element: class="fragment" -->
						* But... <!-- .element: class="fragment" -->
						</script>
					</section>

					<section data-markdown>
						<script type="text/template">
						## Long-term effects
						* Rigid code, hard to change <!-- .element: class="fragment" -->
						* Untestable code, lack of abstractions <!-- .element: class="fragment" -->
						* Degrades over time <!-- .element: class="fragment" -->
						* Just...not fun - work becomes chore <!-- .element: class="fragment" -->
						</script>
					</section>
				</section>


				<section>
					<section data-markdown>
						# So, BookBeat?
						### How did the code-base look after a year?
					</section>

					<section data-markdown class="image-section" data-background="secret.gif">
					</section>

					<section data-markdown>
						<script type="text/template">
						## Good things first 
						* Build server <!-- .element: class="fragment" -->
						* Fastlane <!-- .element: class="fragment" -->
						* Beta testing <!-- .element: class="fragment" -->
						* Localization <!-- .element: class="fragment" -->
						* AND - They got a business launched <!-- .element: class="fragment" -->
						</script>
					</section>

					<section data-markdown>
						<script type="text/template">
						## Code problems
						* Generally overly-complex <!-- .element: class="fragment" -->
						* Rigid code, hard coupling <!-- .element: class="fragment" -->
						* Really hard to break up dependencies <!-- .element: class="fragment" -->
						* **RestKit & CoreData everywhere** <!-- .element: class="fragment" -->
						</script>
					</section>

					<section data-markdown>
						<script type="text/template">
						## AudioPlayer 
						* 1000 lines monolith <!-- .element: class="fragment" -->
						* Plays, streams, buffers, reports etc. <!-- .element: class="fragment" -->
						* Spaghetti code <!-- .element: class="fragment" -->
						* Untested, untestable <!-- .element: class="fragment" -->
						* Depends on database entities <!-- .element: class="fragment" -->
						</script>
					</section>

					<section data-markdown>
						<script type="text/template">
						## Project problems
						* Slow build times <!-- .element: class="fragment" -->
						* All logic in the app <!-- .element: class="fragment" -->
						* Existing unit tests disabled <!-- .element: class="fragment" -->
						* Can't add tests (segmentation fault 11) <!-- .element: class="fragment" -->
						</script>
					</section>

					<section data-markdown>
						<script type="text/template">
						## How are we handling it?
						* Baby steps! <!-- .element: class="fragment" -->
						* Break up dependencies <!-- .element: class="fragment" -->
						* Make domain model abstract <!-- .element: class="fragment" -->
						* Extract code into libraries <!-- .element: class="fragment" -->
						</script>
					</section>

					<section data-markdown>
						<script type="text/template">
						## CocoaPods
						* Package Manager for iOS <!-- .element: class="fragment" -->
						* Alternatives: Carthage, Swift PM <!-- .element: class="fragment" -->
						* ✖ CocoaPod repo <!-- .element: class="fragment" -->
						* ✔ Private git repos + Development pods <!-- .element: class="fragment" -->
						</script>
					</section>
					
					<section data-markdown>
						<script type="text/template">
						## Libraries: pros
						* Can be used in multiple apps <!-- .element: class="fragment" -->
						* Minimizes the app's responsibility <!-- .element: class="fragment" -->
						* Faster build times → easier testing <!-- .element: class="fragment" -->
						* Reduces coupling, forces abstraction <!-- .element: class="fragment" -->
						</script>
					</section>

					<section data-markdown>
						<script type="text/template">
						## Libraries: cons
						* Slower app build times (not always) <!-- .element: class="fragment" -->
						* Number of pods can pile up <!-- .element: class="fragment" -->
						* Library versioning hell <!-- .element: class="fragment" -->
						* Sometimes too much complexity <!-- .element: class="fragment" -->
						</script>
					</section>

					<section data-markdown>
						<script type="text/template">
						## Current state
						* BookBeat app: 10% less code <!-- .element: class="fragment" -->
						* BBCore (core logic + utils) <!-- .element: class="fragment" -->
						* BBAudioPlayer (audio player) <!-- .element: class="fragment" -->
						* BBDomain (domain model + api) <!-- .element: class="fragment" -->
						* CI & Unit Tests for each project <!-- .element: class="fragment" -->
						</script>
					</section>

					<section data-markdown>
						<script type="text/template">
						## Remaining challenges
						* Make domain model 100% abstract <!-- .element: class="fragment" -->
						* Replace RestKit with Alamofire <!-- .element: class="fragment" -->
						* Replace CoreData with Realm <!-- .element: class="fragment" -->
						* Re-enable tests for main app <!-- .element: class="fragment" -->
						</script>
					</section>
				</section>
					

				<section>

					<section data-markdown>
						# Let's take a look
					</section>
				</section>

				<section>
					<section data-markdown>
						# Wrapping up
					</section>

					<section data-markdown>
						<script type="text/template">
						## BookBeat-specific
						* No silver bullet <!-- .element: class="fragment" -->
						* Works great for us <!-- .element: class="fragment" -->
						* Pods is not the only way <!-- .element: class="fragment" -->
						* Approach depends on the app <!-- .element: class="fragment" -->
						</script>
					</section>

					<section data-markdown>
						<script type="text/template">
						## Some advice
						* Abstract - What, not how <!-- .element: class="fragment" -->
						* Get good practices in place early on <!-- .element: class="fragment" -->
						* Reduce coupling (DI) <!-- .element: class="fragment" -->
						* Write tests, at least one test <!-- .element: class="fragment" -->
						</script>
					</section>
				</section>

				<section data-markdown>
					# Thank you!
					* @danielsaidi
				</section>

			</div>
		</div>

		<script src="../lib/js/head.min.js"></script>
		<script src="../js/reveal.js"></script>

		<script>

			// Full list of configuration options available at:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,

				transition: 'slide', // none/fade/slide/convex/concave/zoom

				// Optional reveal.js plugins
				dependencies: [
					{ src: '../lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: '../plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: '../plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: '../plugin/highlight/highlight.js', async: true, condition: function() { return !!document.querySelector( 'pre code' ); }, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: '../plugin/zoom-js/zoom.js', async: true },
					{ src: '../plugin/notes/notes.js', async: true }
				]
			});

		</script>

	</body>
</html>
